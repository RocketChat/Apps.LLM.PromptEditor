import{o as S,b as y,a3 as x,a4 as C,i as d,q as L,s as u}from"./entry.381c0f38.js";import{_ as k}from"./_plugin-vue_export-helper.c27b6911.js";import{u as I}from"./appearence.49def14a.js";import{u as P}from"./composables.be1eba47.js";import{u as A}from"./shiki.f3c9dbee.js";import{u as B}from"./idb.5d3753e0.js";import{u as D}from"./deta.22dfe5c4.js";import{u as E,a as T,p as z}from"./conversation.48b3da9f.js";import{u as K}from"./persona.25e10461.js";import{l as t}from"./log.2adae07e.js";const m=""+globalThis.__publicAssetsURL("image/logo-splash.svg");const N={},_=e=>(x("data-v-4e87ae58"),e=e(),C(),e),R={fixed:"","inset-0":"",class:"dark:bg-dark-4 light:bg-gray-1/40",flex:"","items-center":"","justify-center":"","text-color":"","text-7":""},U=_(()=>d("img",{src:m,"w-40":"","z-2":""},null,-1)),j=_(()=>d("img",{absolute:"",src:m,"w-40":"","blur-30":"","z-1":""},null,-1)),q=[U,j];function F(e,o){return S(),y("div",R,q)}const Y=k(N,[["render",F],["__scopeId","data-v-4e87ae58"]]);async function Z(e){{const{isOnSharePage:o}=L(),{setPalette:f}=I();P(),f(),A().setupShikiLanguages(),e!=null&&e.disableStorage&&B({disableStorage:!0});const{isDetaEnabled:g,deta:r}=D(),{currentConversation:v,conversationList:s,createConversation:h,updateConversationList:c,switchConversation:l}=E(),{initPersonaList:p,personaList:b}=K();u(async()=>{b.value.length===0&&await p()});const{updateKnowledgeList:w}=T();await w(),e!=null&&e.embedded&&t.info("Embedded mode enabled"),g.value&&!o.value&&(t.info("Deta is enabled, syncing conversations"),r.conversation.list().then(a=>{const n=z(10);t.info(`Syncing ${a.length} conversations`),Promise.all(a.map(i=>n(()=>r.conversation.sync(i.key)))).then(()=>{t.info("Finished syncing conversations"),c()})})),u(async()=>{if(v.value===null){if(s.value===null){await c();return}if(s.value&&s.value.length===0&&!(e!=null&&e.embedded)){t.info("No conversations present, creating a new one");const a=await h("Untitled Conversation");await l(a.id)}else if(!(e!=null&&e.embedded)){t.info("Switching to most recent conversation");const a=s.value.sort((n,i)=>i.updatedAt.getTime()-n.updatedAt.getTime())[0];await l(a.id)}}})}}export{Y as _,Z as u};
