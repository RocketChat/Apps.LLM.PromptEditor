import{o as S,b as y,a7 as x,a8 as C,j as u,s as L,a4 as k,a9 as I,h as P,v as d,U as s,aa as A}from"./entry.3cc83cf9.js";import{_ as B}from"./_plugin-vue_export-helper.c27b6911.js";import{u as D}from"./composables.895f1fb5.js";import{u as E}from"./shiki.62655d8c.js";import{u as T,a as U}from"./conversation.a2f82f2b.js";import{u as j}from"./persona.78db4550.js";const _=""+globalThis.__publicAssetsURL("image/logo-splash.svg");const z={},m=e=>(x("data-v-4e87ae58"),e=e(),C(),e),K={fixed:"","inset-0":"",class:"dark:bg-dark-4 light:bg-gray-1/40",flex:"","items-center":"","justify-center":"","text-color":"","text-7":""},N=m(()=>u("img",{src:_,"w-40":"","z-2":""},null,-1)),R=m(()=>u("img",{absolute:"",src:_,"w-40":"","blur-30":"","z-1":""},null,-1)),F=[N,R];function M(e,o){return S(),y("div",K,F)}const J=B(z,[["render",M],["__scopeId","data-v-4e87ae58"]]);async function Q(e){{const{isOnSharePage:o}=L(),{setPalette:f}=k();D(),f(),E().setupShikiLanguages(),e!=null&&e.disableStorage&&I({disableStorage:!0});const{isDetaEnabled:g,deta:r}=P(),{currentConversation:v,conversationList:t,createConversation:h,updateConversationList:c,switchConversation:l}=T(),{initPersonaList:p,personaList:b}=j();d(async()=>{b.value.length===0&&await p()});const{updateKnowledgeList:w}=U();await w(),e!=null&&e.embedded&&s.info("Embedded mode enabled"),g.value&&!o.value&&(s.info("Deta is enabled, syncing conversations"),r.conversation.list().then(a=>{const n=A(10);s.info(`Syncing ${a.length} conversations`),Promise.all(a.map(i=>n(()=>r.conversation.sync(i.key)))).then(()=>{s.info("Finished syncing conversations"),c()})})),d(async()=>{if(v.value===null){if(t.value===null){await c();return}if(t.value&&t.value.length===0&&!(e!=null&&e.embedded)){s.info("No conversations present, creating a new one");const a=await h("Untitled Conversation");await l(a.id)}else if(!(e!=null&&e.embedded)){s.info("Switching to most recent conversation");const a=t.value.sort((n,i)=>i.updatedAt.getTime()-n.updatedAt.getTime())[0];await l(a.id)}}})}}export{J as _,Q as u};
